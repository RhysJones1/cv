<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">   
    <link rel="stylesheet" href="css/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Inputs</title>
</head>
<body>
    <h1>Different types of HTML inputs</h1>
    <input type ="text" id="" name=""><br>
    <input type = "button" value="Submit"><br>
    <input type ="file"><br>
    <input type ="date"><br>
    <input type="radio"><br>
    <input type = "range"><br> 
    <hr>
    <a href="index.html">Go Home</a> 
</body>
</html>


package uk.gov.dvla.osl.etl.service;


import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import uk.gov.dvla.osl.etl.common.service.ReferenceDataService;
import uk.gov.dvla.osl.etl.common.utils.ActivityLogger;
import uk.gov.dvla.osl.etl.extract.mappers.ModelMapper;
import uk.gov.dvla.osl.etl.extract.mappers.PropulsionTypeMapper;
import uk.gov.dvla.osl.etl.extract.mappers.ReferenceDataMapper;
import uk.gov.dvla.osl.etl.extract.repo.*;
import uk.gov.dvla.osl.etl.load.repo.*;

import static org.junit.jupiter.api.Assertions.assertNotNull;

public class ReferenceDataServiceTest {
    @Mock
    private ExtractColourRepo extractColourRepo;
    @Mock
    private ExtractBodyTypeRepo extractBodyTypeRepo;
    @Mock
    private ExtractMakeRepo extractMakeRepo;
    @Mock
    private ExtractModelRepo extractModelRepo;
    @Mock
    private ExtractPropulsionTypeRepo extractPropulsionTypeRepo;
    @Mock
    private ExtractTaxClassRepo extractTaxClassRepo;
    @Mock
    private ExtractWheelplanRepo extractWheelplanRepo;
    @Mock

    private LoadColourRepo loadColourRepo;
    @Mock
    private LoadBodyTypeRepo loadBodyTypeRepo;
    @Mock
    private LoadMakeRepo loadMakeRepo;
    @Mock
    private LoadModelRepo loadModelRepo;
    @Mock
    private LoadPropulsionTypeRepo loadPropulsionTypeRepo;
    @Mock
    private LoadTaxClassRepo loadTaxClassRepo;
    @Mock
    private LoadWheelplanRepo loadWheelplanRepo;
    @Mock
    private LoadUpdateHistoryRepo loadUpdateHistoryRepo;
    @Mock
    private ReferenceDataMapper referenceDataMapper;
    @Mock
    private PropulsionTypeMapper propulsionTypeMapper;
    @Mock
    private ModelMapper modelMapper;

    @Mock
    private ActivityLogger activityLogger;

    @InjectMocks
    private ReferenceDataService referenceDataService;

    @BeforeEach
    void setUp(){
        MockitoAnnotations.openMocks(this);
    }

    @Test
    void testReferenceDataServiceInstantiation(){
        assertNotNull(referenceDataService);
    }

    @Test
    void testProcessColour(){

    }


    private void processColour() {
        loadColourRepo.saveAll(
                extractColourRepo.findAll().stream()
                        .map(referenceDataMapper::mapReferenceData)
                        .map(ColourDocument::new)
                        .collect(Collectors.toList())
        );
        loadUpdateHistoryRepo.save(new UpdateHistoryDocument(ReferenceDataType.COLOUR));
        activityLogger.logComplete(ReferenceDataType.COLOUR.getValue());
    }

package uk.gov.dvla.osl.etl.load.documents;

import org.springframework.data.mongodb.core.mapping.Document;
import uk.gov.dvla.osl.etl.extract.models.ReferenceDataModel;

@Document(collection = "colour")
public class ColourDocument extends ReferenceDataDocument {
    public ColourDocument(ReferenceDataModel model) {
        super(model);
    }
}

package uk.gov.dvla.osl.etl.extract.models;

import lombok.Data;
import javax.persistence.Id;
import javax.persistence.MappedSuperclass;

@MappedSuperclass
@Data
public abstract class ReferenceDataModel {
    @Id
    private String code;

    private String description;
}

package uk.gov.dvla.osl.etl.extract.models;

import javax.persistence.Entity;
import javax.persistence.Table;

@Entity
@Table(name = "COLOUR")
public class ColourModel extends ReferenceDataModel {
}

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import uk.gov.dvla.osl.etl.common.service.ReferenceDataService;
import uk.gov.dvla.osl.etl.common.utils.ActivityLogger;
import uk.gov.dvla.osl.etl.extract.mappers.ReferenceDataMapper;
import uk.gov.dvla.osl.etl.extract.models.ColourModel;
import uk.gov.dvla.osl.etl.extract.repo.ExtractColourRepo;
import uk.gov.dvla.osl.etl.load.documents.ColourDocument;
import uk.gov.dvla.osl.etl.load.repo.LoadColourRepo;
import uk.gov.dvla.osl.etl.load.repo.LoadUpdateHistoryRepo;
import uk.gov.dvla.osl.etl.load.repo.UpdateHistoryDocument;
import uk.gov.dvla.osl.etl.load.repo.ReferenceDataType;

import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

import static org.mockito.Mockito.*;
import static org.junit.jupiter.api.Assertions.*;


public class ReferenceDataServiceTest {

    @Mock
    private ExtractColourRepo extractColourRepo;

    @Mock
    private LoadColourRepo loadColourRepo;

    @Mock
    private LoadUpdateHistoryRepo loadUpdateHistoryRepo;

    @Mock
    private ReferenceDataMapper referenceDataMapper;

    @Mock
    private ActivityLogger activityLogger;

    @InjectMocks
    private ReferenceDataService referenceDataService;

    @BeforeEach
    void setUp() {
        MockitoAnnotations.openMocks(this);
    }

    @Test
    void testProcessColour() {
        // Given: Mock some ColourModel data from the DB
        List<ColourModel> mockColours = Arrays.asList(
                new ColourModel() {{
                    setCode("001");
                    setDescription("Red");
                }},
                new ColourModel() {{
                    setCode("002");
                    setDescription("Blue");
                }}
        );

        // Mock extractColourRepo to return these colours
        when(extractColourRepo.findAll()).thenReturn(mockColours);

        // Mock referenceDataMapper to map ColourModel to ColourDocument
        when(referenceDataMapper.mapReferenceData(any(ColourModel.class)))
                .thenAnswer(invocation -> {
                    ColourModel model = invocation.getArgument(0);
                    return new ColourDocument(model);  // Map ColourModel to ColourDocument
                });

        // Mock saveAll and save operations
        doNothing().when(loadColourRepo).saveAll(anyList());
        doNothing().when(loadUpdateHistoryRepo).save(any(UpdateHistoryDocument.class));
        doNothing().when(activityLogger).logComplete(anyString());

        // When: Call the processColour method
        referenceDataService.processColour();

        // Then: Verify interactions with the mocks
        verify(extractColourRepo, times(1)).findAll();
        verify(referenceDataMapper, times(2)).mapReferenceData(any(ColourModel.class));
        verify(loadColourRepo, times(1)).saveAll(anyList());
        verify(loadUpdateHistoryRepo, times(1)).save(any(UpdateHistoryDocument.class));
        verify(activityLogger, times(1)).logComplete(ReferenceDataType.COLOUR.getValue());
    }
}

